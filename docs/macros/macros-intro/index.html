<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Intro | Emanate Biostats User Guide</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://emanate-biostats-inc.github.io/user-guide/docs/macros/macros-intro"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Intro | Emanate Biostats User Guide"><meta data-react-helmet="true" name="description" content="This page is not meant to be a comprehensive macro guide. Instead, the goal is to provide an introduction to macros to have enough knowledge to be comfortable using all the macros on this site."><meta data-react-helmet="true" property="og:description" content="This page is not meant to be a comprehensive macro guide. Instead, the goal is to provide an introduction to macros to have enough knowledge to be comfortable using all the macros on this site."><link data-react-helmet="true" rel="icon" href="/user-guide/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://emanate-biostats-inc.github.io/user-guide/docs/macros/macros-intro"><link data-react-helmet="true" rel="alternate" href="https://emanate-biostats-inc.github.io/user-guide/docs/macros/macros-intro" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://emanate-biostats-inc.github.io/user-guide/docs/macros/macros-intro" hreflang="x-default"><link rel="stylesheet" href="/user-guide/assets/css/styles.8c5d1235.css">
<link rel="preload" href="/user-guide/assets/js/runtime~main.2cb1be53.js" as="script">
<link rel="preload" href="/user-guide/assets/js/main.1ef17303.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/user-guide/"><div class="navbar__logo"><img src="/user-guide/img/logo.svg" alt="Emanate Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/user-guide/img/logo.svg" alt="Emanate Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Emanate Biostats User Guide</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/user-guide/docs/programming/programming-intro">Programming</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/user-guide/docs/macros/macros-intro">Macros</a><a class="navbar__item navbar__link" href="/user-guide/docs/settings/settings-intro">Settings</a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/user-guide/docs/macros/macros-intro">Macros</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/user-guide/docs/macros/macros-intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/using-this-guide">Using this Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/user-guide/docs/macros/macros-validation/comparenobs">Validation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/macros-validation/comparenobs">%compareNobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/macros-validation/proc-compare">%proc_compare</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/user-guide/docs/macros/macros-validation/listings/primarydata">Listings</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/macros-validation/listings/primarydata">%primaryData</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/user-guide/docs/macros/macros-sdtm/sdtm-pre">SDTM</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/macros-sdtm/sdtm-pre">%sdtm_pre</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/macros-sdtm/sdtm-post">%sdtm_post</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/user-guide/docs/macros/macros-adam/mergesupp">ADaM</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/user-guide/docs/macros/macros-adam/mergesupp">%mergeSupp</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Intro</h1></header><p>This page is not meant to be a comprehensive macro guide. Instead, the goal is to provide an introduction to macros to have enough knowledge to be comfortable using all the macros on this site.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="macro">Macro<a class="hash-link" href="#macro" title="Direct link to heading">â€‹</a></h2><p>A SAS macro is a subroutine that can be called within a larger program.
It is an &quot;independent code module that fulfills some task and is referenced within a larger body of source code. The fundamental role is to offer a single point of reference for some goal or task that the programmer can trigger by invoking the macro.&quot; <a href="https://www.techopedia.com/definition/3727/procedure" target="_blank" rel="noopener noreferrer">ref</a></p><p>Subroutine is a &quot;sequence of program instructions that performs a specific task, packaged as a unit. This unit can then be used in programs wherever that particular task should be performed. The content of a subroutine is its body, which is the piece of program code that is executed when the subroutine is called or invoked. A subroutine may be written so that it expects to obtain one or more data values from the calling program (to replace its parameters or formal parameters). The calling program provides actual values for these parameters, called arguments.&quot; <a href="https://en.wikipedia.org/wiki/Subroutine" target="_blank" rel="noopener noreferrer">ref</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="why">Why<a class="hash-link" href="#why" title="Direct link to heading">â€‹</a></h2><p>Macros increase efficiency and quality of life by providing solutions to reptitive tasks, not reinventing the wheel, etc.</p><p>Macros can make up the backbone behind an entire process (%rtfbreak) or a simple utility to check something small (%nobs)</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="what-makes-up-a-macro">What Makes up a Macro?<a class="hash-link" href="#what-makes-up-a-macro" title="Direct link to heading">â€‹</a></h2><p>Think of it this way. SAS has permanent, built in functions (e.g., index()). Macros are similar, but they are temporary, user-defined, and do not have to return a value. These are wiped from our SAS session after resetting(link) or closing out of SAS.</p><p>Syntactically, macros look like a function, but they act are more like a procedure.</p><p>There are three parts to a macro: the definition, the call (or invocation), and the outcome.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="defintion">Defintion<a class="hash-link" href="#defintion" title="Direct link to heading">â€‹</a></h3><p>When you run the macro definition, you are basically defining a new procedure for SAS. Here is an example definition. The only requirement is %macro, %mend, and a name.</p><div class="codeBlockContainer_J+bg language-sas theme-code-block"><div class="codeBlockContent_csEI sas"><pre tabindex="0" class="prism-code language-sas codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">%macro exampleMacro;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data test1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        message = &quot;Hello World!&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        put message;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%mend exampleMacro;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>After running the definition, SAS has now compiled exampleMacro and stores the code it contains.</p><p><a href="https://www.lexjansen.com/nesug/nesug04/pm/pm07.pdf" target="_blank" rel="noopener noreferrer">Reference</a></p><p>&quot;Once a macro definition is submitted, the macro processor compiles the definition and produces a member in the WORK session SASMACR catalog.&quot;</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="call">Call<a class="hash-link" href="#call" title="Direct link to heading">â€‹</a></h3><p>Here is the call (invocation) of our macro.</p><div class="codeBlockContainer_J+bg language-sas theme-code-block"><div class="codeBlockContent_csEI sas"><pre tabindex="0" class="prism-code language-sas codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">%exampleMacro;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="outcome">Outcome<a class="hash-link" href="#outcome" title="Direct link to heading">â€‹</a></h3><p>After running the call, we get the outcome of the original macro definition. This example macro created a dataset called &quot;test1&quot; and a message to the log, &quot;Hello World!&quot;.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-and-arguments">Parameters and Arguments<a class="hash-link" href="#parameters-and-arguments" title="Direct link to heading">â€‹</a></h2><p>Macros can be defined to have parameters. Parameters are variables in the macro definition that require the user to input arguments to be used inside the macro for specific purposes.</p><p>The macro below has three parameters: <em>date</em>, <em>refDate</em>, and <em>output</em>.</p><div class="codeBlockContainer_J+bg language-sas theme-code-block"><div class="codeBlockContent_csEI sas"><pre tabindex="0" class="prism-code language-sas codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">%macro studyDayDate (date, refDate, output);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ^cmiss(&amp;date, &amp;refDate) then do;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        studyDay = &amp;date - &amp;refDate + (&amp;date &gt;= &amp;refDate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &amp;output = strip(put(&amp;date, date9.)) || &quot; (&quot; || strip(put(studyDay, best.)) || &quot;)&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else &amp;output = strip(put(&amp;date, date9.));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%mend;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Therefore, the user must input three arguments when calling the macro. In the call below, we input <em>aestdtn</em>, <em>trtsdt</em>, and <em>date1</em>.</p><div class="codeBlockContainer_J+bg language-sas theme-code-block"><div class="codeBlockContent_csEI sas"><pre tabindex="0" class="prism-code language-sas codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">data final;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merge ae (in=a) adsl (in=b);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    by subjid;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if a &amp; b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    %studyDayDate(aestdtn, trtsdt, date1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><em>aestdtn</em> and <em>trtsdt</em> get passed through the macro, and together they create <em>date1</em> inside the dataset <em>final</em>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="optional-parameters">Optional Parameters<a class="hash-link" href="#optional-parameters" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_J+bg language-sas theme-code-block"><div class="codeBlockContent_csEI sas"><pre tabindex="0" class="prism-code language-sas codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">%macro test (date, fontsize = 9, var = true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%mend;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><em>data</em> is a required parameter, while <em>fontsize</em> and <em>var</em> are optional parameters.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Emanate-Biostats-Inc/user-guide/blob/master/docs/macros/macros-intro.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/user-guide/docs/macros/using-this-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Using this Guide</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#macro" class="table-of-contents__link toc-highlight">Macro</a></li><li><a href="#why" class="table-of-contents__link toc-highlight">Why</a></li><li><a href="#what-makes-up-a-macro" class="table-of-contents__link toc-highlight">What Makes up a Macro?</a><ul><li><a href="#defintion" class="table-of-contents__link toc-highlight">Defintion</a></li><li><a href="#call" class="table-of-contents__link toc-highlight">Call</a></li><li><a href="#outcome" class="table-of-contents__link toc-highlight">Outcome</a></li></ul></li><li><a href="#parameters-and-arguments" class="table-of-contents__link toc-highlight">Parameters and Arguments</a></li><li><a href="#optional-parameters" class="table-of-contents__link toc-highlight">Optional Parameters</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/user-guide/docs/programming/programming-intro">Programming</a></li><li class="footer__item"><a class="footer__link-item" href="/user-guide/docs/macros/macros-intro">Macros</a></li><li class="footer__item"><a class="footer__link-item" href="/user-guide/docs/settings/settings-intro">Settings</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/user-guide/assets/js/runtime~main.2cb1be53.js"></script>
<script src="/user-guide/assets/js/main.1ef17303.js"></script>
</body>
</html>